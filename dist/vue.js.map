{"version":3,"file":"vue.js","sources":["../src/observe/array.js","../src/observe/index.js","../src/initState.js","../src/init.js","../src/index.js"],"sourcesContent":["//重写数组方法\n//获取原来的数组方法\\'\nlet oldArrayProtoMethods=Array.prototype\n\n//继承\n\nexport let ArrayMethods=Object.create(oldArrayProtoMethods)\n\n//劫持\n\nlet methods=['push','pop','unshift','shift','splice']\n\nmethods.forEach(item=>{\n    ArrayMethods[item]=function (...args){\n        // 劫持数组\n        console.log('%carray.js line:16 数组劫持', 'color: #007acc;');\n        let result=oldArrayProtoMethods[item].apply(this,args)\n        let inserted\n        switch(item){\n            case 'push':\n            case 'unshift':\n                inserted=args //将添加的数据进行获取\n                break;\n            case 'splice':\n                inserted=args.splice(2); //最后一个\n        }\n        let ob=this.__ob__\n        if(inserted){\n            ob.observerArray(inserted) //对添加的数据进行劫持\n        }\n        return result\n    }\n})","import { ArrayMethods } from \"./array\"\n\nexport function observe(data) {\n\n    //1.判断\n    if (typeof data != 'object' || data == null) {\n        return data\n    }\n    // 如果是对象\n    return new Observe(data)\n\n}\nclass Observe {\n    constructor(value) {\n        //定义属性,传递this\n        Object.defineProperty(value, '__ob__', {\n            enumerable: false, //不可枚举/遍历\n            value: this\n        })\n        //判断是数组还是对象\n        if (Array.isArray(value)) {\n            //函数劫持\n            value.__proto__ = ArrayMethods\n            //如果是数组对象\n            this.observerArray(value)\n        } else {\n            this.walk(value) //便利\n        }\n    }\n    //对象属性\n    walk(data) {\n        let keys = Object.keys(data)\n        for (let i = 0; i < keys.length; i++) {\n            //对每个属性进行劫持\n            let key = keys[i]\n            let value = data[key]\n            definRtactive(data, key, value)\n        }\n    }\n    // 数组对象劫持\n    observerArray(value) {\n        for (let i = 0; i < value.length; i++) {\n            observe(value[i])\n        }\n    }\n}\n//对data里的对象属性进行劫持\nfunction definRtactive(data, key, value) {\n    observe(value) //递归深度劫持\n    Object.defineProperty(data, key, {\n        get() {\n            console.log('%cindex.js line:29 获取', 'color: #007acc;');\n            return value\n        },\n        set(newValue) {\n            console.log('%cindex.js line:33 修改', 'color: #007acc;');\n            if (newValue == value) return value\n            observe(newValue) //深度劫持,将修改过的数据再次进行劫持\n            value = newValue\n        }\n    })\n}\n//对数组进行劫持","import { observe } from \"./observe/index.js\";\n\nexport function initState(vm){\n    let opts=vm.$options\n    //对数据初始化处理\n    if(opts.data){\n        initData(vm)\n    }\n\n    function initData(vm){\n        //判断data 是对象/函\n        let data=vm.$options.data\n        data=vm._data=typeof data==='function'?data.call(vm):data \n        //数据劫持 -- vue2数据响应式原理\n        observe(data) //\n        //data{} 对象   数组\n    }\n}","import { initState } from \"./initState.js\"\n\n\nexport function initMixin(Vue){\n    Vue.prototype._init=function(options){\n        \n        let vm=this\n        vm.$options=options\n        // 初始化状态\n        initState(vm)\n    }\n}\n","import { initMixin } from \"./init\"\n\nfunction Vue(options){\n    //初始化\n    this._init(options)\n\n}\ninitMixin(Vue)\nexport default Vue"],"names":[],"mappings":"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"}